{% extends "base.html" %}

{% block title %}{% if customer %}ç¼–è¾‘{% else %}æ·»åŠ {% endif %}å®¢æˆ· - åŒ»è¯ç®¡ç†ç³»ç»Ÿ{% endblock %}
{% block page_title %}{% if customer %}ç¼–è¾‘{% else %}æ·»åŠ {% endif %}å®¢æˆ·{% endblock %}

{% block content %}
<div class="page-header">
    <h2>{% if customer %}ç¼–è¾‘{% else %}æ·»åŠ {% endif %}å®¢æˆ·</h2>
    {% if not customer %}
    <button type="button" onclick="quickFill('customer')" class="btn btn-success">
        ğŸ² å¿«é€Ÿå¡«å……æµ‹è¯•æ•°æ®
    </button>
    {% endif %}
</div>

<div class="table-card">
    <form method="post" onsubmit="return validateCustomerForm()">
        <div class="form-row">
            <div class="form-group">
                <label for="name">å®¢æˆ·åç§° *</label>
                <input type="text" id="name" name="name" class="form-control" 
                       value="{{ customer.name if customer else '' }}" 
                       placeholder="ä¾‹å¦‚ï¼šå¼ ä¸‰/å¹¸ç¦åŒ»é™¢" required>
            </div>
            
            <div class="form-group">
                <label for="type">ç±»å‹</label>
                <select id="type" name="type" class="form-control">
                    <option value="é›¶å”®" {% if customer and customer.type == 'é›¶å”®' %}selected{% endif %}>é›¶å”®</option>
                    <option value="æ‰¹å‘" {% if customer and customer.type == 'æ‰¹å‘' %}selected{% endif %}>æ‰¹å‘</option>
                </select>
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label for="contact">è”ç³»äºº</label>
                <input type="text" id="contact" name="contact" class="form-control" 
                       value="{{ customer.contact if customer else '' }}"
                       placeholder="ä¾‹å¦‚ï¼šæå››">
            </div>
            
            <div class="form-group">
                <label for="phone">ç”µè¯</label>
                <input type="tel" id="phone" name="phone" class="form-control" 
                       value="{{ customer.phone if customer else '' }}"
                       placeholder="ä¾‹å¦‚ï¼š13912345678">
            </div>
        </div>
        
        <div class="form-group">
            <label for="address">åœ°å€</label>
            <input type="text" id="address" name="address" class="form-control" 
                   value="{{ customer.address if customer else '' }}"
                   placeholder="ä¾‹å¦‚ï¼šåŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯1å·">
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">ä¿å­˜</button>
            <a href="{{ url_for('basic.customer_list') }}" class="btn btn-secondary">å–æ¶ˆ</a>
        </div>
    </form>
</div>

<script>
function validateCustomerForm() {
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    
    if (!name) {
        alert('è¯·è¾“å…¥å®¢æˆ·åç§°');
        return false;
    }
    
    // ç”µè¯å·ç éªŒè¯
    if (phone && !/^1[3-9]\d{9}$/.test(phone)) {
        if (!confirm('æ‰‹æœºå·æ ¼å¼å¯èƒ½ä¸æ­£ç¡®ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ')) {
            return false;
        }
    }
    
    return true;
}
</script>

<style>
.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

@media (max-width: 768px) {
    .form-row {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
